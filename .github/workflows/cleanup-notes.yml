name: Delete Old Notes

on:
  schedule:
    - cron: "0 0 * * *"  # Runs daily at midnight UTC
  workflow_dispatch:  # Allows manual execution

jobs:
  cleanup:
    runs-on: ubuntu-latest

    steps:
      - name: Call Notes Cleanup API
        env:
          CLEANUP_URL: ${{ secrets.NOTES_CLEANUP_URL }}
        run: |
          if [ -z "$CLEANUP_URL" ]; then
            echo "❌ ERROR: NOTES_CLEANUP_URL is not set!"
            exit 1
          fi
          echo "✅ Triggering cleanup at: $CLEANUP_URL"
          curl -X GET "$CLEANUP_URL"
